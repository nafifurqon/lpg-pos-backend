# 2026-02-28 00.00.00-STORY-Register Shop-LPG-2

| Field       | Value                  |
|-------------|------------------------|
| **ID**      | LPG-2                  |
| **Type**    | Story                  |
| **Status**  | In Progress            |
| **Feature** | 01-register-login      |

## User Story Statement

As an authenticated owner,
I want to register my shop,
so that I can start using the POS system.

## Background / Context

After registering and logging in, an owner must register their shop before they can use the POS features. Each owner may only have one shop. This endpoint is the entry point to setting up the shop's identity in the system.

- Related to BE-05 in `docs/stories/01-register-login.md`
- Requires a valid access token (Bearer)

## Business Rules / Functional Requirements

- `POST /shops` requires a valid JWT access token in the `Authorization: Bearer` header
- Request body must include:
  - `name` — required, string, min 5, max 100 characters
  - `address` — required, string, min 5, max 500 characters
  - `registrationNumber` — optional, string, max 50 characters
- An owner can only register **one** shop; duplicate registration returns `409 Conflict`
- Returns `201 Created` with the created shop object wrapped in the standard envelope

## Acceptance Criteria

- [ ] `POST /shops` requires valid access token — `401` if missing or invalid
- [ ] Validates `name` (required, min 5, max 100) — `400` on violation with `messages[]`
- [ ] Validates `address` (required, min 5, max 500) — `400` on violation with `messages[]`
- [ ] Validates `registrationNumber` (optional, max 50) — `400` on violation if provided
- [ ] Returns `201` with `{ message: "Toko berhasil didaftarkan", result: { id, name, address, registrationNumber, createdAt, updatedAt } }` on success
- [ ] Returns `409` if the authenticated owner already has a registered shop
- [ ] `owner_id` in `shops` table has a UNIQUE constraint enforcing one shop per owner

## Out of Scope

- Shop update / delete endpoints
- Multiple shops per owner
- Frontend integration (separate task)
