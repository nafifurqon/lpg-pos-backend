# Implementation Plan — Add Swagger API Documentation

## Overview

| Field | Value |
|---|---|
| **Plan ID** | BE-PLAN-04 |
| **Feature** | API Documentation via Swagger / OpenAPI |
| **Related Stories** | LPG-4 |
| **Author** | — |
| **Date** | 2026-02-28 |
| **Status** | Done |

## Goal

Install and configure `@nestjs/swagger` to expose Swagger UI at `/docs`.
All 8 existing endpoints across `AuthController`, `ShopsController`, and
`DashboardController` will be fully annotated. DTOs will carry manual `@ApiProperty`
decorators (no CLI plugin) with `description` and `example` for every field.
A new `AuthResponseDto` class replaces the inline `AuthResult` type so Swagger
can describe the auth response schema.

## Scope

### In Scope

- `@nestjs/swagger` package installation
- Swagger bootstrap in `main.ts` at `/docs`
- `@ApiTags`, `@ApiOperation`, `@ApiResponse`, `@ApiBearerAuth` on all controllers
- Manual `@ApiProperty` / `@ApiPropertyOptional` on all request DTOs
- New `src/auth/dto/auth-response.dto.ts` with `UserInAuthDto` + `AuthResponseDto`

### Out of Scope

- OpenAPI spec file export
- Auto-generated SDKs
- NestJS Swagger CLI plugin

## Affected Files

| File | Change Type | Notes |
|---|---|---|
| `package.json` | Modify | Add `@nestjs/swagger` |
| `src/main.ts` | Modify | Bootstrap Swagger UI |
| `src/auth/dto/auth-response.dto.ts` | Create | Response DTO for auth endpoints |
| `src/auth/dto/register-email.dto.ts` | Modify | Add `@ApiProperty` |
| `src/auth/dto/login-email.dto.ts` | Modify | Add `@ApiProperty` |
| `src/auth/dto/google-auth.dto.ts` | Modify | Add `@ApiProperty` |
| `src/auth/auth.controller.ts` | Modify | Add Swagger decorators |
| `src/shops/dto/create-shop.dto.ts` | Modify | Add `@ApiProperty` |
| `src/shops/shops.controller.ts` | Modify | Add Swagger decorators |
| `src/dashboard/dashboard.controller.ts` | Modify | Add Swagger decorators |

## Implementation Steps

1. **Install** — `npm i @nestjs/swagger` in `backend/`
2. **Bootstrap** — In `main.ts`, use `DocumentBuilder` to set title/description/version, call `addBearerAuth()`, then `SwaggerModule.setup('docs', app, document)`
3. **Auth Response DTO** — Create `src/auth/dto/auth-response.dto.ts`:
   - `UserInAuthDto` with `id`, `email`, `role` fields
   - `AuthResponseDto` with `access_token`, `refresh_token`, `user: UserInAuthDto`
4. **Annotate request DTOs** — Add manual `@ApiProperty` with `description` and `example` to all fields in `RegisterEmailDto`, `LoginEmailDto`, `GoogleAuthDto`, `CreateShopDto`
5. **Annotate `AuthController`** — `@ApiTags('Auth')` on class; per-handler: `@ApiOperation`, `@ApiResponse(201/200/400/401/409)` with `type: AuthResponseDto`; `@ApiBearerAuth()` on `refresh` & `logout`
6. **Annotate `ShopsController`** — `@ApiTags('Shops')` + class-level `@ApiBearerAuth()`; per-handler `@ApiOperation` + `@ApiResponse`
7. **Annotate `DashboardController`** — `@ApiTags('Dashboard')` + class-level `@ApiBearerAuth()`; `@ApiOperation` + `@ApiResponse`
8. **Verify** — Start backend, visit `http://localhost:6000/docs`, confirm all endpoints and schemas

## API Changes

No new endpoints. Swagger UI at `GET /docs`.

## Environment Variable Changes

None.

## Rollback Plan

- `npm uninstall @nestjs/swagger`
- Revert `main.ts` and all annotated controller/DTO files

## Verification Checklist

- [x] Swagger UI loads at `http://localhost:6000/docs`
- [x] All 8 endpoints visible: 5 Auth, 2 Shops, 1 Dashboard
- [x] Request body schemas shown for POST endpoints
- [x] `AuthResponseDto` schema rendered correctly
- [x] Protected endpoints show lock icon
- [x] `npx tsc --noEmit` passes with no errors
- [x] Story LPG-4 marked Done
